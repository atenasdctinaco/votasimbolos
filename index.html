<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√≠mbolos Naturales | Municipio Tinaco</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --azul-tinaco: #1a2980; 
            --rojo-tinaco: #ff0000;
            --blanco: #ffffff;
            --glass: rgba(255, 255, 255, 0.12);
        }
        
        body {
            margin: 0; font-family: 'Outfit', sans-serif;
            background: linear-gradient(135deg, var(--azul-tinaco) 0%, #26d0ce 100%);
            background-attachment: fixed; color: #fff; overflow-x: hidden;
        }

        .glass-card {
            background: var(--glass); backdrop-filter: blur(25px);
            border-radius: 30px; border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
        }

        .screen { display: none; min-height: 100vh; padding: 40px 20px; box-sizing: border-box; }
        .active { display: flex; flex-direction: column; align-items: center; justify-content: center; animation: fadeIn 0.6s ease; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- FORMULARIO CORREGIDO --- */
        .form-group { width: 100%; margin-bottom: 15px; text-align: left; }
        .row { display: flex; gap: 15px; width: 100%; }
        .col-short { flex: 0 0 80px; } /* Edad corta */
        .col-wide { flex: 1; }

        input, select {
            width: 100%; padding: 12px; margin-top: 5px; border-radius: 12px; border: none; 
            font-family: 'Outfit'; box-sizing: border-box; background: white; color: #333;
        }

        /* Prefijo de pa√≠s */
        .phone-input { display: flex; gap: 5px; }
        .phone-input select { width: 90px; }

        /* --- IM√ÅGENES Y BOTONES --- */
        .img-container {
            width: 100%; height: 250px; background: rgba(0,0,0,0.3);
            border-radius: 20px; position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden;
        }
        .img-container img { max-width: 100%; max-height: 100%; object-fit: contain; }
        
        .zoom-btn {
            position: absolute; top: 10px; right: 10px; background: var(--rojo-tinaco);
            color: white; border: none; border-radius: 50%; width: 35px; height: 35px; cursor: pointer;
        }

        .btn-action {
            background: var(--rojo-tinaco); color: white; border: none; padding: 18px 30px;
            border-radius: 20px; cursor: pointer; font-weight: 700; transition: 0.3s; 
            width: 100%; display: flex; align-items: center; justify-content: center; gap: 10px;
            text-transform: uppercase; font-size: 0.9rem;
        }
        .btn-action:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
        .btn-action:disabled { background: #555; cursor: not-allowed; opacity: 0.7; }

        /* --- ACORDE√ìN --- */
        .accordion { background: rgba(255,255,255,0.1); border-radius: 15px; margin: 20px 0; width: 100%; }
        .accordion-header { padding: 15px; cursor: pointer; background: rgba(255,255,255,0.2); font-weight: bold; }
        .accordion-content { max-height: 0; overflow: hidden; transition: 0.3s; background: rgba(0,0,0,0.2); text-align: left; }

        footer { text-align: center; padding: 40px 20px; font-size: 0.85rem; opacity: 0.8; border-top: 1px solid rgba(255,255,255,0.1); }
        .grid-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 25px; width: 100%; max-width: 1200px; padding-bottom: 50px;}
    </style>
</head>
<body>

<section id="screen-intro" class="screen active">
    <div class="glass-card" style="max-width: 750px; padding: 40px; text-align: center;">
        <h2 style="letter-spacing: 3px; font-weight: 300;">ALCALD√çA DE TINACO</h2>
        <h1 style="font-size: 2.8rem; margin: 10px 0; line-height: 1;">Identidad Natural</h1>
        
        <div class="accordion">
            <div class="accordion-header" onclick="toggleAcc()"><i class="fas fa-info-circle"></i> VER ANTECEDENTES DEL PROCESO</div>
            <div id="acc-body" class="accordion-content">
                <div style="padding: 20px; font-size: 0.9rem;">
                    <p>üî∞ <b>Comisi√≥n T√©cnica:</b> Creada para proteger el patrimonio natural del municipio.</p>
                    <p>üî∏ <b>Consulta Previa:</b> Se visitaron 40 sectores rurales y urbanos (226 encuestados).</p>
                    <p>üî∏ <b>Resultados:</b> El <b>Roble Criollo</b> es nuestro √Årbol Emblem√°tico. Sin embargo, en flores y aves hubo vac√≠os t√©cnicos que esta nueva consulta ciudadana busca solventar con tu apoyo.</p>
                </div>
            </div>
        </div>
        <button class="btn-action" onclick="nextScreen('screen-form')">EMPEZAR VOTACI√ìN</button>
    </div>
</section>

<section id="screen-form" class="screen">
    <div class="glass-card" style="max-width: 550px; padding: 35px; width: 90%;">
        <h2 style="text-align: center; margin-bottom: 20px;">Registro Auditado</h2>
        
        <div class="form-group">
            <label>C√©dula de Identidad *</label>
            <input type="number" id="v-ci" placeholder="Solo n√∫meros">
        </div>

        <div class="form-group">
            <label>Nombre Completo *</label>
            <input type="text" id="v-nombre">
        </div>
        
        <div class="row">
            <div class="col-short">
                <label>Edad *</label>
                <input type="number" id="v-edad" min="1">
            </div>
            <div class="col-wide">
                <label>G√©nero *</label>
                <select id="v-genero">
                    <option value="F">Femenino</option>
                    <option value="M">Masculino</option>
                    <option value="O">Prefiero no decir</option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label>Sector de Residencia (Escr√≠balo) *</label>
            <input type="text" id="v-sector" placeholder="Ej: San Luis, Centro...">
        </div>

        <div class="form-group">
            <label>WhatsApp (Opcional)</label>
            <div class="phone-input">
                <select id="v-country">
                    <option value="+58" selected>üáªüá™ +58</option>
                    <option value="+57">üá®üá¥ +57</option>
                    <option value="+1">üá∫üá∏ +1</option>
                    <option value="+34">üá™üá∏ +34</option>
                </select>
                <input type="tel" id="v-ws" placeholder="N√∫mero">
            </div>
        </div>

        <button class="btn-action" onclick="validateForm()">VALIDAR Y CONTINUAR</button>
    </div>
</section>

<section id="screen-selector" class="screen">
    <h2 style="font-size: 2.2rem; text-align: center;">Etapas de Selecci√≥n</h2>
    <p>Debes completar ambas categor√≠as para finalizar.</p>
    <div class="grid-cards" style="max-width: 800px;">
        <div class="glass-card" style="padding: 40px; text-align: center; cursor: pointer;" onclick="renderVotacion('aves')">
            <i class="fas fa-feather-alt fa-5x"></i>
            <h3>AVES</h3>
            <div id="check-ave" style="display:none; color: #00ff00; font-weight: bold;">‚úÖ COMPLETADO</div>
        </div>
        <div class="glass-card" style="padding: 40px; text-align: center; cursor: pointer;" onclick="renderVotacion('flores')">
            <i class="fas fa-seedling fa-5x"></i>
            <h3>FLORES</h3>
            <div id="check-flor" style="display:none; color: #00ff00; font-weight: bold;">‚úÖ COMPLETADO</div>
        </div>
    </div>
</section>

<section id="screen-voting" class="screen">
    <h2 id="vote-title" style="margin-bottom: 30px;"></h2>
    <div class="grid-cards" id="container-voting"></div>
    <button class="btn-action" style="max-width: 200px; background: rgba(0,0,0,0.4);" onclick="nextScreen('screen-selector')">VOLVER</button>
</section>

<section id="screen-final" class="screen">
    <div class="glass-card" style="max-width: 600px; padding: 50px; text-align: center;">
        <h2 style="font-size: 2rem;">Validaci√≥n de Identidad Digital</h2>
        <p>Para procesar su voto, el sistema requiere confirmar su apoyo a la divulgaci√≥n cient√≠fica de nuestro municipio.</p>
        <br>
        <a href="https://www.youtube.com/@epistecnologia?sub_confirmation=1" target="_blank" class="btn-action" style="background: #ff0000; text-decoration: none;" onclick="unlockBtn()">
            <i class="fab fa-youtube"></i> SUSCRIBIRSE A EPISTECNOLOG√çA
        </a>
        <br>
        <button id="finish-v" class="btn-action" disabled onclick="finalizarSistema()">
            <i class="fas fa-check-circle"></i> CONFIRMAR Y FINALIZAR
        </button>
        <p id="msg-unlock" style="font-size: 0.8rem; margin-top: 10px; opacity: 0.7;">* El bot√≥n se activar√° al hacer clic en suscribirse.</p>
    </div>
</section>

<section id="screen-results" class="screen">
    <div class="glass-card" style="width: 95%; max-width: 1100px; padding: 40px; text-align: center;">
        <h1>Escrutinio en Tiempo Real</h1>
        <div class="row" style="flex-wrap: wrap; justify-content: center;">
            <div style="width: 450px; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 20px;">
                <canvas id="chartAves"></canvas>
            </div>
            <div style="width: 450px; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 20px;">
                <canvas id="chartFlores"></canvas>
            </div>
        </div>
        <br>
        <button class="btn-action" style="max-width: 300px; margin: auto;" onclick="location.reload()">NUEVA VOTACI√ìN</button>
    </div>
</section>

<footer>
    <p><b>ALCALD√çA DEL MUNICIPIO TINACO</b><br>
    Sistema desarrollado por <b>Epistecnolog√≠a</b>. Plataforma y revista internacional de divulgaci√≥n cient√≠fica y cultural desarrollada por un tinaquero.</p>
</footer>

<div id="image-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:3000; align-items:center; justify-content:center;" onclick="this.style.display='none'">
    <img id="modal-img" src="" style="max-width: 95%; max-height: 95%; border-radius: 10px; border: 2px solid white;">
</div>

<script>
    // --- DATOS EDUCATIVOS AMPLIADOS ---
    const dataAves = [
        {id: 'carp', nombre: 'Carpintero', img: 'https://i.ibb.co/kg3YG0dP/large.jpg', desc: 'Ingeniero del bosque. Sus nidos sirven de hogar para otras especies. Controla plagas de insectos de forma natural.'},
        {id: 'sang', nombre: 'Sangre toro', img: 'https://i.ibb.co/NnGg1Q86/900.jpg', desc: 'Destaca por su plumaje rojo carmes√≠. Habita en bordes de bosques y sabanas, simbolizando la vitalidad de nuestra tierra.'},
        {id: 'cris', nombre: 'CristoFue', img: 'https://i.ibb.co/nNLYqT3M/900.jpg', desc: 'Ave vigilante de canto inconfundible. Es omn√≠vora y muy adaptable, presente en cada rinc√≥n de los hogares tinaqueros.'},
        {id: 'gab', nombre: 'El Gaban', img: 'https://i.ibb.co/HTL8cxgG/43dac00274fc4fe2e1f4ced2ce7f8459.jpg', desc: 'Gran cig√ºe√±a de los llanos. Representa la salud de nuestros humedales y la elegancia de la fauna acu√°tica.'},
        {id: 'alc', nombre: 'Alcaravan', img: 'https://inaturalist-open-data.s3.amazonaws.com/photos/135057906/large.jpeg', desc: 'Guardi√°n del suelo. Posee un sistema de alarma natural que protege a otras especies durante la noche.'}
    ];

    const dataFlores = [
        {id: 'lirio', nombre: 'Lirio Sabanero', img: 'https://i.ibb.co/Zz4Rwj1j/Lirio-Sabanero.jpg', desc: 'Flor resiliente que emerge tras las primeras lluvias del llano. Su fragancia es delicada y su color blanco simboliza pureza.'},
        {id: 'noel', nombre: 'Noelia', img: 'https://i.ibb.co/DXPFPv8/153688966573326366.jpg', desc: 'Planta de gran valor ornamental en Tinaco. Sus flores en racimos atraen polinizadores y embellecen los jardines tradicionales.'},
        {id: 'bot', nombre: 'Bototo', img: 'https://i.ibb.co/KzzmNF9b/Bototo.jpg', desc: 'Conocido como el "oro del llano". Sus flores amarillas brillantes aparecen cuando el √°rbol pierde sus hojas, indicando el cambio de estaci√≥n.'},
        {id: 'naz', nombre: 'Nazareno', img: 'https://i.ibb.co/wmfqWGG/shutterstock-1056956174.jpg', desc: 'Flor de tonos p√∫rpuras profundos. Vinculada a la espiritualidad local y la biodiversidad de nuestros bosques secos.'},
        {id: 'cim', nombre: 'Cimbapotro', img: 'https://i.ibb.co/DDxwXZbB/floripondio.jpg', desc: 'Especie silvestre aut√≥ctona. Es un componente clave del ecosistema local, adaptada perfectamente al clima de Cojedes.'},
        {id: 'cla', nombre: 'Clavelina', img: 'https://i.ibb.co/KpP5FFb3/clavelina-rebecca-niver-z0txuuculfq-unsplash-946793cd-1200x630.jpg', desc: 'Llamada el "orgullo de los jardines". Sus flores parecen fuegos artificiales y tienen propiedades medicinales tradicionales.'}
    ];

    let userVoto = { ave: null, flor: null };

    // --- L√ìGICA DE NAVEGACI√ìN ---
    function nextScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0,0);
    }

    function toggleAcc() {
        const b = document.getElementById('acc-body');
        b.style.maxHeight = b.style.maxHeight ? null : b.scrollHeight + "px";
    }

    function validateForm() {
        const ci = document.getElementById('v-ci').value;
        const nombre = document.getElementById('v-nombre').value;
        const sector = document.getElementById('v-sector').value;
        const edad = document.getElementById('v-edad').value;

        if(!ci || !nombre || !sector || !edad) {
            alert("Por favor rellene todos los campos obligatorios (*)");
            return;
        }
        nextScreen('screen-selector');
    }

    function renderVotacion(tipo) {
        const container = document.getElementById('container-voting');
        const lista = tipo === 'aves' ? dataAves : dataFlores;
        document.getElementById('vote-title').innerText = tipo === 'aves' ? 'ELIJA EL AVE S√çMBOLO' : 'ELIJA LA FLOR S√çMBOLO';
        container.innerHTML = '';

        lista.forEach(item => {
            const card = document.createElement('div');
            card.className = "glass-card";
            card.style.padding = "20px";
            card.innerHTML = `
                <div class="img-container">
                    <img src="${item.img}">
                    <button class="zoom-btn" onclick="viewImg('${item.img}')"><i class="fas fa-expand"></i></button>
                </div>
                <h3 style="margin:15px 0 5px 0; color:#ffd700;">${item.nombre}</h3>
                <p style="font-size:0.85rem; line-height:1.2; height:60px; overflow-y:auto; margin-bottom:15px; padding-right:5px;">${item.desc}</p>
                
                <div style="display:flex; gap:10px;">
                    ${tipo === 'aves' ? `<button class="btn-action" style="flex:0 0 50px; background:#222;" onclick="reproducirCanto('${item.nombre}')"><i class="fas fa-volume-up"></i></button>` : ''}
                    <button class="btn-action" onclick="setVoto('${tipo}', '${item.nombre}')">VOTAR</button>
                </div>
            `;
            container.appendChild(card);
        });
        nextScreen('screen-voting');
    }

    function viewImg(url) {
        document.getElementById('modal-img').src = url;
        document.getElementById('image-modal').style.display = 'flex';
    }

    function reproducirCanto(nombre) {
        alert("Funci√≥n Educativa: En la versi√≥n final aqu√≠ se reproducir√° el canto real del " + nombre + " (Archivos .mp3 cargados en Supabase/GitHub).");
    }

    function setVoto(tipo, nombre) {
        if(tipo === 'aves') { userVoto.ave = nombre; document.getElementById('check-ave').style.display='block'; }
        else { userVoto.flor = nombre; document.getElementById('check-flor').style.display='block'; }

        if(userVoto.ave && userVoto.flor) nextScreen('screen-final');
        else nextScreen('screen-selector');
    }

    // --- L√ìGICA SOCIAL GATE ---
    function unlockBtn() {
        const btn = document.getElementById('finish-v');
        const msg = document.getElementById('msg-unlock');
        setTimeout(() => {
            btn.disabled = false;
            btn.style.background = "#27ae60";
            msg.innerHTML = "‚úÖ ¬°Validado! Ahora puede finalizar.";
            msg.style.color = "#00ff00";
        }, 2000);
    }

    function finalizarSistema() {
        nextScreen('screen-results');
        renderFinalCharts();
    }

    function renderFinalCharts() {
        const base = {
            plugins: { legend: { labels: { color: '#fff' } } },
            scales: { y: { ticks: { color: '#fff' } }, x: { ticks: { color: '#fff' } } }
        };

        new Chart(document.getElementById('chartAves'), {
            type: 'doughnut',
            data: { labels: dataAves.map(a=>a.nombre), datasets: [{ data: [15, 25, 40, 10, 10], backgroundColor: ['#1a2980','#ff0000','#ffd700','#27ae60','#8e44ad'] }] },
            options: { plugins: { title: { display: true, text: 'Preferencias Aves', color: '#fff' } } }
        });

        new Chart(document.getElementById('chartFlores'), {
            type: 'bar',
            data: { labels: dataFlores.map(f=>f.nombre), datasets: [{ label: 'Votos', data: [12, 19, 3, 5, 2, 8], backgroundColor: '#ffd700' }] },
            options: base
        });
    }
</script>
</body>
</html>
