<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tinaco Elige | Epistecnolog√≠a</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --azul-tinaco: #1a2980; 
            --rojo-tinaco: #ff0000;
            --blanco: #ffffff;
            --glass: rgba(255, 255, 255, 0.12);
        }
        
        body {
            margin: 0; font-family: 'Outfit', sans-serif;
            background: linear-gradient(135deg, var(--azul-tinaco) 0%, #26d0ce 100%);
            background-attachment: fixed; color: #fff;
            overflow-x: hidden;
        }

        /* --- ESTILO GEN Z --- */
        .glass-card {
            background: var(--glass); backdrop-filter: blur(25px);
            border-radius: 35px; border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .glass-card:hover { transform: scale(1.03) translateY(-15px); background: rgba(255,255,255,0.2); }

        .screen { display: none; min-height: 100vh; padding: 40px 20px; box-sizing: border-box; }
        .active { display: flex; flex-direction: column; align-items: center; justify-content: center; animation: slideUp 0.7s ease-out; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(60px); } to { opacity: 1; transform: translateY(0); } }

        /* --- BOTONES --- */
        .btn-action {
            background: var(--rojo-tinaco); color: white; border: none; padding: 18px 45px;
            border-radius: 25px; cursor: pointer; font-weight: 700; font-size: 1.1rem;
            box-shadow: 0 12px 25px rgba(255, 0, 0, 0.4); transition: 0.4s;
            text-transform: uppercase; letter-spacing: 1px;
        }
        .btn-action:hover { transform: translateY(-5px); box-shadow: 0 18px 35px rgba(255, 0, 0, 0.6); }
        .btn-action:disabled { background: #444; box-shadow: none; cursor: not-allowed; opacity: 0.6; }

        /* --- GRID Y CARTAS --- */
        .grid-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; width: 100%; max-width: 1300px; padding: 20px; }
        .card-img { width: 100%; height: 240px; object-fit: cover; border-radius: 30px; margin-bottom: 20px; }
        
        .info-panel { display: none; padding: 15px; background: rgba(0,0,0,0.5); border-radius: 20px; margin: 15px 0; font-size: 0.95em; line-height: 1.5; border-left: 4px solid var(--rojo-tinaco); }

        /* --- DOCK SOCIAL --- */
        .social-dock { position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); display: flex; gap: 20px; background: rgba(0,0,0,0.6); padding: 15px 35px; border-radius: 60px; backdrop-filter: blur(15px); z-index: 1000; border: 1px solid rgba(255,255,255,0.1); }
        .social-dock i { font-size: 1.6rem; color: #fff; transition: 0.4s; cursor: pointer; }
        .social-dock i:hover { color: var(--rojo-tinaco); transform: rotate(15deg) scale(1.3); }

    </style>
</head>
<body>

<section id="screen-intro" class="screen active">
    <div class="glass-card" style="max-width: 650px; padding: 60px; text-align: center;">
        <h1 style="font-size: 3.5rem; margin-bottom: 15px; letter-spacing: -2px;">Tinaco Elige üó≥Ô∏è</h1>
        <p style="font-size: 1.3rem; opacity: 0.9; margin-bottom: 30px;">Votaci√≥n Ciudadana para los S√≠mbolos Naturales de nuestro Municipio. Un proyecto de <b>Epistecnolog√≠a</b>.</p>
        <button class="btn-action" onclick="nextScreen('screen-geo')">Comenzar Ahora</button>
    </div>
</section>

<section id="screen-geo" class="screen">
    <div class="glass-card" style="padding: 50px; text-align: center; width: 100%; max-width: 500px;">
        <h2 style="font-size: 2rem; margin-bottom: 20px;">üìç Auditor√≠a de Origen</h2>
        <p style="margin-bottom: 30px;">Selecciona tu sector para validar la transparencia del proceso:</p>
        <select id="user-zone" style="width: 100%; padding: 20px; border-radius: 20px; border: none; font-size: 1.1rem; background: #fff; color: #333; cursor: pointer;">
            <option value="Casco Central">Casco Central</option>
            <option value="Lomas del Viento">Lomas del Viento</option>
            <option value="San Luis">San Luis</option>
            <option value="El Pao">El Pao</option>
            <option value="Sabana Larga">Sabana Larga</option>
            <option value="La Villeguera">La Villeguera</option>
        </select>
        <br><br>
        <button class="btn-action" onclick="saveGeo()">Siguiente Paso</button>
    </div>
</section>

<section id="screen-selector" class="screen">
    <h2 style="font-size: 2.5rem; text-shadow: 0 10px 20px rgba(0,0,0,0.4); margin-bottom: 40px;">¬øQu√© eliges primero?</h2>
    <div class="grid-cards" style="max-width: 900px;">
        <div class="glass-card" style="padding: 40px; text-align: center; cursor: pointer;" onclick="startVoto('aves')">
            <i class="fas fa-feather-alt fa-5x" style="color: #fff; margin-bottom: 20px;"></i>
            <h3>AVES</h3>
            <span id="badge-aves" style="display:none; background: #27ae60; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem;">‚úÖ LISTO</span>
        </div>
        <div class="glass-card" style="padding: 40px; text-align: center; cursor: pointer;" onclick="startVoto('flores')">
            <i class="fas fa-seedling fa-5x" style="color: #fff; margin-bottom: 20px;"></i>
            <h3>FLORES</h3>
            <span id="badge-flores" style="display:none; background: #27ae60; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem;">‚úÖ LISTO</span>
        </div>
    </div>
</section>

<section id="screen-voto" class="screen">
    <h2 id="voto-title" style="font-size: 2.2rem; margin-bottom: 40px; text-align: center;"></h2>
    <div class="grid-cards" id="container-voto"></div>
    <button class="btn-action" style="margin-top: 30px; background: #222;" onclick="nextScreen('screen-selector')">Regresar</button>
</section>

<section id="screen-social" class="screen">
    <div class="glass-card" style="max-width: 600px; padding: 60px; text-align: center;">
        <h2 style="font-size: 2.5rem; margin-bottom: 20px;">√öltimo Paso üöÄ</h2>
        <p style="font-size: 1.1rem; margin-bottom: 40px;">Para confirmar tu participaci√≥n y apoyar la divulgaci√≥n, suscr√≠bete a nuestro canal de YouTube:</p>
        <a href="https://www.youtube.com/@epistecnologia?sub_confirmation=1" target="_blank" class="btn-action" style="background: #ff0000; display: block; text-decoration: none; margin-bottom: 20px;" onclick="unlockFinish()">
            <i class="fab fa-youtube"></i> SUSCRIBIRSE A EPISTECNOLOG√çA
        </a>
        <button id="btn-finalizar" class="btn-action" disabled onclick="finalizarTodo()" style="width: 100%;">FINALIZAR MI VOTO</button>
    </div>
</section>

<section id="screen-results" class="screen">
    <div class="glass-card" style="width: 95%; max-width: 1100px; padding: 50px; text-align: center;">
        <h1 style="font-size: 3rem; margin-bottom: 10px;">¬°Gracias, Tinaco!</h1>
        <p style="opacity: 0.8; margin-bottom: 40px;">Resultados acumulados auditados por sector y preferencia:</p>
        <div style="display: flex; flex-wrap: wrap; gap: 30px; justify-content: center;">
            <div style="width: 450px; background: rgba(255,255,255,0.08); padding: 25px; border-radius: 30px;">
                <canvas id="chartAves"></canvas>
            </div>
            <div style="width: 450px; background: rgba(255,255,255,0.08); padding: 25px; border-radius: 30px;">
                <canvas id="chartFlores"></canvas>
            </div>
        </div>
        <br><br>
        <button class="btn-action" onclick="location.reload()">Nuevo Participante</button>
    </div>
</section>

<div class="social-dock">
    <i class="fab fa-instagram"></i>
    <i class="fab fa-whatsapp"></i>
    <i class="fab fa-facebook"></i>
    <i class="fab fa-youtube"></i>
</div>

<script>
    // --- DATOS ACTUALIZADOS ---
    const dataAves = [
        {id: 'carp', nombre: 'Carpintero', img: 'https://i.ibb.co/kg3YG0dP/large.jpg', desc: 'Ave arquitecta, fundamental para la salud de nuestros √°rboles.'},
        {id: 'sang', nombre: 'Sangre toro', img: 'https://i.ibb.co/NnGg1Q86/900.jpg', desc: 'Icono llanero de plumaje rojo carmes√≠ vibrante.'},
        {id: 'cris', nombre: 'CristoFue', img: 'https://i.ibb.co/nNLYqT3M/900.jpg', desc: 'Vigilante incansable con un canto que identifica a Tinaco.'},
        {id: 'gab', nombre: 'El Gaban', img: 'https://i.ibb.co/HTL8cxgG/43dac00274fc4fe2e1f4ced2ce7f8459.jpg', desc: 'La m√°xima elegancia de nuestros esteros y lagunas.'},
        {id: 'alc', nombre: 'Alcaravan', img: 'https://inaturalist-open-data.s3.amazonaws.com/photos/135057906/large.jpeg', desc: 'Fiel guardi√°n de la sabana, s√≠mbolo de protecci√≥n.'}
    ];

    const dataFlores = [
        {id: 'lirio', nombre: 'Lirio Sabanero', img: 'https://images.unsplash.com/photo-1597430302648-97171d1e43e7?auto=format&fit=crop&w=400', desc: 'La pureza blanca que nace de nuestras sabanas.'},
        {id: 'noel', nombre: 'Noelia', img: 'https://images.unsplash.com/photo-1550159516-cd294fb8ce1b?auto=format&fit=crop&w=400', desc: 'Flor ornamental de gran tradici√≥n en los jardines tinaqueros.'},
        {id: 'bot', nombre: 'Bototo', img: 'https://images.unsplash.com/photo-1524147023055-5bc77b74495c?auto=format&fit=crop&w=400', desc: 'Color amarillo oro que ilumina nuestros paisajes llaneros.'},
        {id: 'naz', nombre: 'Nazareno', img: 'https://images.unsplash.com/photo-1567608285969-48e3ca032924?auto=format&fit=crop&w=400', desc: 'Espiritualidad y belleza en tonos p√∫rpuras profundos.'},
        {id: 'cim', nombre: 'Cimbapotro', img: 'https://images.unsplash.com/photo-1464332521191-423588e1e70d?auto=format&fit=crop&w=400', desc: 'Resistencia y belleza silvestre de nuestra flora aut√≥ctona.'},
        {id: 'clav', nombre: 'Clavellina', img: 'https://images.unsplash.com/photo-1582794543139-8ac9cb0f7b11?auto=format&fit=crop&w=400', desc: 'Fuegos artificiales naturales en nuestros senderos.'}
    ];

    let v_ave = null, v_flor = null, v_zona = "";

    // --- NAVEGACI√ìN ---
    function nextScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0,0);
    }

    function saveGeo() {
        v_zona = document.getElementById('user-zone').value;
        nextScreen('screen-selector');
    }

    function startVoto(tipo) {
        const title = document.getElementById('voto-title');
        const container = document.getElementById('container-voto');
        const lista = tipo === 'aves' ? dataAves : dataFlores;
        
        title.innerText = tipo === 'aves' ? "Elige el Ave S√≠mbolo" : "Elige la Flor S√≠mbolo";
        container.innerHTML = "";

        lista.forEach(item => {
            const card = document.createElement('div');
            card.className = "glass-card";
            card.innerHTML = `
                <img src="${item.img}" class="card-img">
                <div style="padding:0 25px 30px 25px;">
                    <h3 style="font-size: 1.5rem; margin-bottom: 10px;">${item.nombre}</h3>
                    <div id="info-${item.id}" class="info-panel">${item.desc}</div>
                    <div style="display:flex; gap:10px; margin-bottom:15px;">
                        <button class="btn-action" style="background:rgba(255,255,255,0.2); box-shadow:none; padding:12px; flex:1" onclick="document.getElementById('info-${item.id}').style.display='block'">VER +</button>
                        ${tipo === 'aves' ? `<button class="btn-action" style="background:#222; box-shadow:none; padding:12px 18px;" onclick="alert('Reproduciendo canto del ${item.nombre}...')"><i class="fas fa-volume-up"></i></button>` : ''}
                    </div>
                    <button class="btn-action" style="width:100%;" onclick="registrar('${tipo}', '${item.nombre}')">SELECCIONAR</button>
                </div>
            `;
            container.appendChild(card);
        });
        nextScreen('screen-voto');
    }

    function registrar(tipo, nombre) {
        if(tipo === 'aves') { v_ave = nombre; document.getElementById('badge-aves').style.display='inline-block'; }
        else { v_flor = nombre; document.getElementById('badge-flores').style.display='inline-block'; }

        if(v_ave && v_flor) nextScreen('screen-social');
        else nextScreen('screen-selector');
    }

    function unlockFinish() {
        setTimeout(() => {
            const btn = document.getElementById('btn-finalizar');
            btn.disabled = false;
            btn.style.background = "#27ae60";
            btn.style.boxShadow = "0 10px 20px rgba(39, 174, 96, 0.4)";
        }, 3000);
    }

    function finalizarTodo() {
        // En producci√≥n aqu√≠ conectar√°s con Supabase
        nextScreen('screen-results');
        renderCharts();
    }

    function renderCharts() {
        const config = (title, labels) => ({
            type: 'doughnut',
            data: { labels, datasets: [{ data: labels.map(() => Math.floor(Math.random() * 60) + 15), backgroundColor: ['#1a2980', '#ff0000', '#f1c40f', '#27ae60', '#8e44ad', '#e67e22'] }] },
            options: { plugins: { legend: { labels: { color: '#fff', font: { size: 12 } } }, title: { display: true, text: title, color: '#fff', font: { size: 18 } } } }
        });
        new Chart(document.getElementById('chartAves'), config('Tendencias Aves', dataAves.map(a => a.nombre)));
        new Chart(document.getElementById('chartFlores'), config('Tendencias Flores', dataFlores.map(f => f.nombre)));
    }
</script>

</body>
</html>
